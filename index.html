<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CSM PRO - Construction Sales Manager</title>
    <!-- Tailwind CSS ë¡œë”© ì‹¤íŒ¨ ëŒ€ë¹„ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í¬í•¨ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap');
        body { font-family: 'Pretendard', -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; background-color: #f8fafc; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .card-shadow { box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.07); }
        .active-tab { color: #4f46e5; opacity: 1 !important; }
        canvas { touch-action: none; border-radius: 1rem; }
        .loading-overlay { position: fixed; inset: 0; background: white; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        /* ì•„ì´ì½˜ ë¡œë”© ì „ê¹Œì§€ ê³µê°„ í™•ë³´ë¥¼ ìœ„í•œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .icon-placeholder { width: 24px; height: 24px; display: inline-block; background: #e2e8f0; border-radius: 4px; }
    </style>
</head>
<body class="text-slate-900">

<!-- ì´ˆê¸° ë¡œë”© í™”ë©´ -->
<div id="loading-screen" class="loading-overlay">
    <div class="w-12 h-12 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
    <p class="mt-4 font-bold text-slate-500 text-sm">ì‹œìŠ¤í…œ ì—°ê²° ì¤‘...</p>
</div>

<div id="app" class="max-w-md mx-auto min-h-screen flex flex-col relative hidden">
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="bg-white/90 backdrop-blur-md sticky top-0 z-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center">
        <div>
            <h1 class="text-xl font-black text-indigo-600 tracking-tighter italic">CSM PRO</h1>
            <p class="text-[9px] font-bold text-slate-400">CONSTRUCTION SALES MASTER</p>
        </div>
        <div class="flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-full border border-slate-100">
            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
            <span class="text-[10px] font-black text-slate-600" id="user-display">ì ‘ì† ì¤‘</span>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
    <main id="viewport" class="flex-1 overflow-y-auto px-4 pt-6 pb-32 no-scrollbar"></main>

    <!-- ë°”í…€ ë‚´ë¹„ê²Œì´ì…˜ -->
    <nav class="fixed bottom-6 left-4 right-4 max-w-md mx-auto bg-white/95 backdrop-blur-lg border border-slate-200/50 rounded-[2rem] flex justify-around items-center py-4 shadow-2xl z-[100]">
        <button onclick="window.nav('dashboard')" class="nav-btn flex flex-col items-center gap-1 opacity-40 transition-all" data-id="dashboard">
            <i data-lucide="layout-grid" class="w-5 h-5"></i>
            <span class="text-[9px] font-bold">ëŒ€ì‹œë³´ë“œ</span>
        </button>
        <button onclick="window.nav('sites')" class="nav-btn flex flex-col items-center gap-1 opacity-40 transition-all" data-id="sites">
            <i data-lucide="building-2" class="w-5 h-5"></i>
            <span class="text-[9px] font-bold">í˜„ì¥ê´€ë¦¬</span>
        </button>
        <button onclick="window.nav('partners')" class="nav-btn flex flex-col items-center gap-1 opacity-40 transition-all" data-id="partners">
            <i data-lucide="contact-2" class="w-5 h-5"></i>
            <span class="text-[9px] font-bold">ì¸ë§¥ê´€ë¦¬</span>
        </button>
        <button onclick="window.openAiConsultant()" class="flex flex-col items-center gap-1 text-indigo-500 drop-shadow-sm">
            <i data-lucide="sparkles" class="w-5 h-5"></i>
            <span class="text-[9px] font-bold">AIë¶„ì„</span>
        </button>
    </nav>

    <!-- ì „ì—­ ëª¨ë‹¬ ë ˆì´ì–´ -->
    <div id="modal-overlay" class="fixed inset-0 bg-slate-900/40 z-[200] hidden flex items-end">
        <div id="modal-container" class="bg-white w-full max-h-[90vh] rounded-t-[2.5rem] shadow-2xl transform translate-y-full transition-transform duration-300 flex flex-col">
            <div class="h-1.5 w-12 bg-slate-200 rounded-full mx-auto my-3"></div>
            <div id="modal-body" class="px-6 pb-10 pt-2 overflow-y-auto flex-1 no-scrollbar"></div>
        </div>
    </div>
</div>

<!-- Lucide ì•„ì´ì½˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
<script src="https://unpkg.com/lucide@latest"></script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, collection, doc, setDoc, onSnapshot, deleteDoc, updateDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    // 1. Firebase ì„¤ì • ë° ì´ˆê¸°í™” (RULE 1, 2, 3 ì¤€ìˆ˜)
    const firebaseConfig = JSON.parse(__firebase_config);
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'sales-csm-v1';

    // 2. ìƒíƒœ ê´€ë¦¬
    window.state = {
        user: null,
        currentView: 'dashboard',
        sites: [],
        partners: [],
        logs: [],
        loading: true
    };

    // 3. ì¸ì¦ ì²˜ë¦¬ (RULE 3)
    const initAuth = async () => {
        try {
            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth);
            }
        } catch (err) {
            console.error("Auth Error:", err);
            // ì¬ì‹œë„ ë¡œì§ (Exponential Backoff ìƒëµ, ê°„ë‹¨íˆ ì¬í˜¸ì¶œ)
            setTimeout(initAuth, 2000);
        }
    };

    onAuthStateChanged(auth, (user) => {
        if (user) {
            window.state.user = user;
            document.getElementById('user-display').innerText = user.uid.substring(0, 6);
            document.getElementById('loading-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            startDataSync();
        } else {
            initAuth();
        }
    });

    // 4. ë°ì´í„° ì‹¤ì‹œê°„ ë™ê¸°í™”
    function startDataSync() {
        if (!window.state.user) return;

        const sync = (colName, stateKey) => {
            const q = collection(db, 'artifacts', appId, 'public', 'data', colName);
            onSnapshot(q, (snapshot) => {
                window.state[stateKey] = snapshot.docs.map(d => d.data());
                if (stateKey === 'logs') {
                    window.state.logs.sort((a, b) => b.createdAt - a.createdAt);
                }
                render();
            }, (err) => console.error(`Sync Error [${colName}]:`, err));
        };

        sync('sites', 'sites');
        sync('partners', 'partners');
        sync('logs', 'logs');
    }

    // 5. ë„¤ë¹„ê²Œì´ì…˜ ë° ë Œë”ë§
    window.nav = (view, id = null) => {
        window.state.currentView = view;
        window.state.activeId = id;
        render();
        window.scrollTo(0, 0);
    };

    function render() {
        const vp = document.getElementById('viewport');
        const view = window.state.currentView;

        // ë‚´ë¹„ë°” í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.nav-btn').forEach(b => {
            b.classList.toggle('active-tab', b.dataset.id === view);
        });

        if (view === 'dashboard') renderDashboard(vp);
        else if (view === 'sites') renderList(vp, 'sites', 'ê±´ì„¤ í˜„ì¥');
        else if (view === 'partners') renderList(vp, 'partners', 'í˜‘ë ¥ì‚¬/ì¸ë§¥');
        else if (view === 'site-detail') renderSiteDetail(vp);
        else if (view === 'partner-detail') renderPartnerDetail(vp);

        if (window.lucide) lucide.createIcons();
    }

    // --- ë·° ë Œë”ëŸ¬ í•¨ìˆ˜ë“¤ ---

    function renderDashboard(el) {
        const today = new Date().toISOString().split('T')[0];
        const todayLogs = window.state.logs.filter(l => l.date === today);

        el.innerHTML = `
            <div class="space-y-6">
                <div class="bg-indigo-600 p-8 rounded-[2.5rem] text-white shadow-xl card-shadow relative overflow-hidden">
                    <div class="relative z-10">
                        <p class="text-xs font-bold opacity-70 mb-1 uppercase tracking-widest">Today's Activity</p>
                        <h2 class="text-4xl font-black">${todayLogs.length}<span class="text-lg ml-1 opacity-50 font-medium">ê±´</span></h2>
                        <div class="mt-4 flex gap-2">
                            <span class="text-[10px] bg-white/20 px-2 py-1 rounded-md font-bold">í˜„ì¥ë°©ë¬¸ ${todayLogs.filter(l=>l.cat==='ë°©ë¬¸').length}</span>
                            <span class="text-[10px] bg-white/20 px-2 py-1 rounded-md font-bold">ê²¬ì ì œì¶œ ${todayLogs.filter(l=>l.cat==='ê²¬ì ').length}</span>
                        </div>
                    </div>
                    <div class="absolute right-[-10%] top-[-10%] opacity-10"><i data-lucide="bar-chart-3" class="w-40 h-40"></i></div>
                </div>

                <div class="flex justify-between items-center">
                    <h3 class="font-black text-slate-800 text-lg">ìµœê·¼ í™œë™ ë¡œê·¸</h3>
                    <button onclick="window.openAddLog()" class="bg-white px-4 py-2 rounded-xl text-xs font-black shadow-sm border border-slate-100 text-indigo-600">+ ìƒˆ ë¡œê·¸</button>
                </div>

                <div class="space-y-3 pb-10">
                    ${window.state.logs.slice(0, 10).map(l => `
                        <div class="bg-white p-5 rounded-[1.8rem] border border-slate-100 card-shadow">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-[9px] font-black px-2 py-0.5 bg-slate-100 text-slate-500 rounded uppercase">${l.cat}</span>
                                <span class="text-[10px] font-bold text-slate-300">${l.date}</span>
                            </div>
                            <h4 class="font-black text-slate-800">${l.siteName}</h4>
                            <p class="text-xs text-slate-500 mt-1 line-clamp-2">${l.content}</p>
                        </div>
                    `).join('') || '<div class="py-20 text-center text-slate-300 font-bold">í™œë™ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>'}
                </div>
            </div>
        `;
    }

    function renderList(el, key, title) {
        el.innerHTML = `
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-black text-slate-800">${title}</h2>
                <button onclick="window.openAddModal('${key}')" class="w-10 h-10 bg-indigo-600 text-white rounded-xl shadow-lg flex items-center justify-center">
                    <i data-lucide="plus" class="w-6 h-6"></i>
                </button>
            </div>
            <div class="grid gap-3">
                ${window.state[key].map(item => `
                    <div onclick="window.nav('${key.slice(0,-1)}-detail', '${item.id}')" class="bg-white p-5 rounded-2xl border border-slate-100 card-shadow flex items-center justify-between active:scale-95 transition-all">
                        <div>
                            <p class="font-black text-slate-800">${item.name}</p>
                            <p class="text-[10px] font-bold text-slate-400 mt-1">${item.addr || item.company || 'ìƒì„¸ ì •ë³´ ì—†ìŒ'}</p>
                        </div>
                        <i data-lucide="chevron-right" class="w-5 h-5 text-slate-200"></i>
                    </div>
                `).join('')}
            </div>
        `;
    }

    function renderSiteDetail(el) {
        const site = window.state.sites.find(s => s.id === window.state.activeId);
        if(!site) return;
        const siteLogs = window.state.logs.filter(l => l.siteName === site.name);

        el.innerHTML = `
            <button onclick="window.nav('sites')" class="mb-4 text-slate-400 flex items-center gap-1 font-bold text-sm">
                <i data-lucide="chevron-left" class="w-4 h-4"></i> ë’¤ë¡œê°€ê¸°
            </button>
            <div class="bg-white p-6 rounded-[2.5rem] card-shadow mb-6 border border-indigo-50">
                <h3 class="text-2xl font-black text-slate-800">${site.name}</h3>
                <p class="text-xs font-bold text-slate-400 mt-1 italic">${site.addr || 'ì£¼ì†Œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤'}</p>
                
                <div class="mt-6 flex gap-2">
                    <button class="flex-1 bg-slate-50 py-3 rounded-xl text-[10px] font-black text-slate-500">ë„ë©´ ë³´ê¸°</button>
                    <button class="flex-1 bg-indigo-50 py-3 rounded-xl text-[10px] font-black text-indigo-600">ìœ„ì¹˜ ì§€ë„</button>
                </div>
            </div>

            <div class="space-y-4 pb-20">
                <h4 class="font-black text-slate-800 flex items-center gap-2 px-1">
                    <i data-lucide="history" class="w-4 h-4 text-indigo-500"></i> í˜„ì¥ íˆìŠ¤í† ë¦¬
                </h4>
                ${siteLogs.map(l => `
                    <div class="bg-white p-4 rounded-2xl border border-slate-100 shadow-sm">
                        <div class="flex justify-between mb-2">
                            <span class="text-[9px] font-black text-indigo-500 bg-indigo-50 px-2 py-0.5 rounded">${l.cat}</span>
                            <span class="text-[9px] font-bold text-slate-300">${l.date}</span>
                        </div>
                        <p class="text-xs font-bold text-slate-600 leading-relaxed">${l.content}</p>
                    </div>
                `).join('') || '<div class="py-10 text-center text-slate-300 text-xs font-bold">ì•„ì§ ê¸°ë¡ëœ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</div>'}
            </div>
        `;
    }

    function renderPartnerDetail(el) {
        const partner = window.state.partners.find(p => p.id === window.state.activeId);
        if(!partner) return;
        
        el.innerHTML = `
            <button onclick="window.nav('partners')" class="mb-4 text-slate-400 flex items-center gap-1 font-bold text-sm">
                <i data-lucide="chevron-left" class="w-4 h-4"></i> ë’¤ë¡œê°€ê¸°
            </button>
            <div class="bg-white p-8 rounded-[2.5rem] card-shadow text-center">
                <div class="w-20 h-20 bg-indigo-100 rounded-3xl mx-auto mb-4 flex items-center justify-center text-indigo-500">
                    <i data-lucide="user" class="w-10 h-10"></i>
                </div>
                <h3 class="text-2xl font-black text-slate-800">${partner.name}</h3>
                <p class="text-sm font-bold text-indigo-600 mb-6">${partner.company || 'ì†Œì† ì •ë³´ ì—†ìŒ'}</p>
                
                <div class="grid grid-cols-2 gap-3">
                    <a href="tel:${partner.phone}" class="bg-slate-900 text-white py-4 rounded-2xl flex items-center justify-center gap-2 text-xs font-bold shadow-lg">
                        <i data-lucide="phone" class="w-4 h-4"></i> ì „í™” ê±¸ê¸°
                    </a>
                    <button class="bg-slate-100 text-slate-600 py-4 rounded-2xl flex items-center justify-center gap-2 text-xs font-bold">
                        <i data-lucide="message-square" class="w-4 h-4"></i> ë¬¸ì ì „ì†¡
                    </button>
                </div>
            </div>

            <div class="mt-8 space-y-4 pb-20 px-1">
                <h4 class="font-black text-slate-800">ì¸ë§¥ ë©”ëª¨</h4>
                <div class="bg-white p-6 rounded-2xl border border-slate-100 min-h-[100px] text-xs font-bold text-slate-500 leading-relaxed">
                    ${partner.memo || 'ë“±ë¡ëœ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤. ì£¼ìš” ê´€ì‹¬ì‚¬ë‚˜ íŠ¹ì§•ì„ ê¸°ë¡í•˜ì„¸ìš”.'}
                </div>
            </div>
        `;
    }

    // --- ë°ì´í„° ì¡°ì‘ ë° ëª¨ë‹¬ ---

    window.openModal = (html) => {
        const overlay = document.getElementById('modal-overlay');
        const container = document.getElementById('modal-container');
        document.getElementById('modal-body').innerHTML = html;
        overlay.classList.remove('hidden');
        setTimeout(() => container.style.transform = 'translateY(0)', 10);
        if (window.lucide) lucide.createIcons();
    };

    window.closeModal = () => {
        const container = document.getElementById('modal-container');
        container.style.transform = 'translateY(100%)';
        setTimeout(() => document.getElementById('modal-overlay').classList.add('hidden'), 300);
    };

    window.openAddModal = (key) => {
        const placeholder = key === 'sites' ? 'í˜„ì¥ëª…ì„ ì…ë ¥í•˜ì„¸ìš”' : 'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”';
        window.openModal(`
            <div class="space-y-5">
                <h3 class="text-xl font-black text-slate-800 mb-2">ì‹ ê·œ ${key === 'sites' ? 'í˜„ì¥' : 'í˜‘ë ¥ì‚¬'} ë“±ë¡</h3>
                <input type="text" id="new-name" placeholder="${placeholder}" class="w-full bg-slate-50 p-5 rounded-2xl border-none outline-none font-bold text-slate-700">
                <input type="text" id="new-sub" placeholder="${key === 'sites' ? 'í˜„ì¥ ì£¼ì†Œ' : 'ì†Œì† íšŒì‚¬'}" class="w-full bg-slate-50 p-5 rounded-2xl border-none outline-none font-bold text-slate-700">
                <button onclick="window.saveItem('${key}')" class="w-full bg-indigo-600 text-white py-5 rounded-2xl font-black shadow-xl active:scale-95 transition-all">ë“±ë¡ ì™„ë£Œ</button>
            </div>
        `);
    };

    window.saveItem = async (key) => {
        const name = document.getElementById('new-name').value;
        const sub = document.getElementById('new-sub').value;
        if(!name) return;
        
        const id = key.slice(0,2) + "_" + Date.now();
        const data = { id, name, createdAt: Date.now() };
        if(key === 'sites') data.addr = sub; else data.company = sub;

        await setDoc(doc(db, 'artifacts', appId, 'public', 'data', key, id), data);
        window.closeModal();
    };

    window.openAddLog = () => {
        window.openModal(`
            <div class="space-y-4">
                <h3 class="text-xl font-black text-slate-800 mb-2">í™œë™ ë¡œê·¸ ê¸°ë¡</h3>
                <div class="space-y-1">
                    <label class="text-[10px] font-black text-slate-400 ml-1">í˜„ì¥ ì„ íƒ</label>
                    <select id="log-site" class="w-full bg-slate-50 p-4 rounded-xl font-bold border-none outline-none">
                        ${window.state.sites.map(s=>`<option value="${s.name}">${s.name}</option>`).join('')}
                    </select>
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <div class="space-y-1">
                        <label class="text-[10px] font-black text-slate-400 ml-1">í™œë™ êµ¬ë¶„</label>
                        <select id="log-cat" class="w-full bg-slate-50 p-4 rounded-xl font-bold border-none outline-none">
                            <option>ë°©ë¬¸</option><option>ê²¬ì </option><option>ë¯¸íŒ…</option><option>ê³„ì•½</option>
                        </select>
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-black text-slate-400 ml-1">ë‚ ì§œ</label>
                        <input type="date" id="log-date" value="${new Date().toISOString().split('T')[0]}" class="w-full bg-slate-50 p-4 rounded-xl font-bold border-none outline-none">
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] font-black text-slate-400 ml-1">í™œë™ ë‚´ìš©</label>
                    <textarea id="log-content" placeholder="íŠ¹ì´ì‚¬í•­ì´ë‚˜ ë‹¤ìŒ í•  ì¼ì„ ì ìœ¼ì„¸ìš”" class="w-full bg-slate-50 p-4 rounded-xl font-bold border-none outline-none h-32 resize-none"></textarea>
                </div>
                <button onclick="window.saveLog()" class="w-full bg-indigo-600 text-white py-5 rounded-2xl font-black shadow-xl active:scale-95 transition-all">ë¡œê·¸ ì €ì¥</button>
            </div>
        `);
    };

    window.saveLog = async () => {
        const site = document.getElementById('log-site').value;
        const content = document.getElementById('log-content').value;
        if(!content) return;

        const id = "log_" + Date.now();
        await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'logs', id), {
            id, siteName: site, cat: document.getElementById('log-cat').value,
            date: document.getElementById('log-date').value,
            content, createdAt: Date.now()
        });
        window.closeModal();
    };

    // --- AI ê¸°ëŠ¥ ---
    window.openAiConsultant = () => {
        window.openModal(`
            <div class="space-y-4">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white italic font-black text-xs">G</div>
                    <h3 class="text-lg font-black text-slate-800">AI ì˜ì—… ë¹„ì„œ</h3>
                </div>
                <div class="bg-indigo-50 p-6 rounded-3xl border border-indigo-100 min-h-[150px] flex items-center justify-center">
                    <p id="ai-text" class="text-sm font-bold text-indigo-800 leading-relaxed text-center italic">í˜„ì¬ ì˜ì—… í™œë™ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ëµì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
                </div>
                <button onclick="window.closeModal()" class="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold">í™•ì¸</button>
            </div>
        `);
        fetchAiStrategy();
    };

    async function fetchAiStrategy() {
        const apiKey = ""; // ì œê³µëœ í™˜ê²½ì—ì„œ ìë™ ì²˜ë¦¬ë¨
        const summary = `í˜„ì¥: ${window.state.sites.length}ê°œ, ìµœê·¼ë¡œê·¸: ${window.state.logs.slice(0,3).map(l=>l.content).join('; ')}`;
        const prompt = `ë‹¹ì‹ ì€ ê±´ì„¤ ì˜ì—… ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë‹¤ìŒ ë°ì´í„°ë¥¼ ë³´ê³  ì˜¤ëŠ˜ ì§‘ì¤‘í•´ì•¼ í•  ì˜ì—… í¬ì¸íŠ¸ 1ê°€ì§€ë¥¼ 100ì ì´ë‚´ì˜ ì¹œì ˆí•œ í•œêµ­ì–´ë¡œ ì œì•ˆí•˜ì„¸ìš”: ${summary}`;

        try {
            const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                method: "POST", headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await resp.json();
            document.getElementById('ai-text').innerText = "ğŸ’¡ " + data.candidates[0].content.parts[0].text;
            document.getElementById('ai-text').classList.remove('text-center', 'italic');
        } catch (err) {
            document.getElementById('ai-text').innerText = "ë°ì´í„° ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ë¥¼ ë” ìŒ“ì•„ë³´ì„¸ìš”!";
        }
    }
</script>

</body>
</html>
